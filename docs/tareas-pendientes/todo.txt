# Tareas Pendientes - Sistema de Checkout PÃºblico y Mercado Pago

## âœ… Completado

### Parte 1: Correcciones CrÃ­ticas de Mercado Pago
- âœ… Agregado scope offline_access en auth-mp-connect
- âœ… Creado mp-token-refresh.ts para refrescar tokens automÃ¡ticamente
- âœ… Corregida validaciÃ³n HMAC en mp-signature.ts
- âœ… Webhooks rechazan requests invÃ¡lidos (401)
- âœ… Creado mp-disconnect Edge Function
- âœ… Actualizadas mp-create-preference y mercadopago-webhook para usar refresh token

### Parte 2: Sistema de Links de Pago
- âœ… MigraciÃ³n enhance_payment_links.sql completada
- âœ… Edge Function create-payment-link creada
- âœ… Edge Function get-payment-link-config creada
- âœ… PaymentLinkModal.tsx actualizado para usar la nueva Edge Function

### Parte 3: APIs PÃºblicas del Checkout
- âœ… Edge Function public-get-salon-services creada
- âœ… Edge Function public-get-salon-stylists creada
- âœ… Edge Function public-get-availability creada
- âœ… Edge Function public-create-appointment creada (integra con MP)

## â³ Pendiente

### Parte 4: Componentes del Frontend del Checkout PÃºblico
- [ ] Crear PublicCheckoutView.tsx con stepper y animaciones framer-motion
- [ ] Crear ServiceSelector.tsx con tarjetas animadas de servicios
- [ ] Crear StylistSelector.tsx con cards de profesionales y opciÃ³n 'cualquiera'
- [ ] Crear DateTimeSelector.tsx con calendario y slots de horarios
- [ ] Crear CustomerInfoForm.tsx con validaciÃ³n en tiempo real
- [ ] Crear CheckoutSummary.tsx con resumen y botÃ³n de pago MP
- [ ] Crear PaymentSuccessView.tsx
- [ ] Crear PaymentFailureView.tsx
- [ ] Crear PaymentPendingView.tsx

### Parte 5: IntegraciÃ³n de Rutas
- [ ] Modificar App.tsx para agregar rutas pÃºblicas /book/:token y /payment/*
- [ ] Crear hook usePublicCheckout para manejar el estado del checkout pÃºblico
- [ ] Integrar las Edge Functions pÃºblicas en los componentes

### Parte 6: Testing y ValidaciÃ³n
- [ ] Probar flujo completo de checkout pÃºblico
- [ ] Validar integraciÃ³n con Mercado Pago
- [ ] Probar webhooks de MP
- [ ] Validar refresh de tokens
- [ ] Probar creaciÃ³n y uso de payment links

### Parte 7: Mejoras Futuras
- [ ] Agregar soporte para mÃºltiples servicios en un solo turno
- [ ] Agregar validaciÃ³n de slots disponibles en tiempo real
- [ ] Implementar notificaciones por email al cliente
- [ ] Agregar analytics para payment links
- [ ] Mejorar UI/UX con mÃ¡s animaciones y feedback visual

## Notas TÃ©cnicas

- Los Edge Functions estÃ¡n listos y funcionando
- La migraciÃ³n de base de datos estÃ¡ aplicada
- PaymentLinkModal estÃ¡ actualizado y funcionando
- Falta implementar los componentes React del checkout pÃºblico
- Las rutas pÃºblicas deben agregarse en App.tsx

